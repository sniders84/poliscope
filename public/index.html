<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Your Officials</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="icon" href="favicon.ico" onerror="this.href='data:,';" />
  <style>
    /* Sticky Home Hub nav styling - match site theme */
    #hub-nav {
      position: sticky;
      top: 0;
      background-color: #2b2b2b; /* dark grey background */
      display: flex;
      gap: 10px;
      padding: 10px;
      border-bottom: 1px solid #444;
      z-index: 1000;
      overflow-x: auto;
    }

    #hub-nav button {
      padding: 8px 12px;
      border: none;
      background-color: #3c3c3c;
      color: #fff;
      cursor: pointer;
      border-radius: 6px;
      white-space: nowrap;
      flex-shrink: 0;
      transition: background-color 0.2s, color 0.2s;
    }

    #hub-nav button:hover {
      background-color: #0066ff; /* blue hover */
      color: #fff;
    }

    /* Category Sections */
    .category-section {
      padding: 20px 0;
      border-bottom: 1px solid #444;
    }

    .card-grid {
      display: grid;
      gap: 12px;
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
    }

    .info-card {
      background-color: #333;
      padding: 14px;
      border-radius: 8px;
      color: #fff;
      transition: transform 0.2s, box-shadow 0.2s;
      cursor: pointer;
    }

    .info-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    }

    /* Social feed placeholder */
    #social-feed {
      display: grid;
      gap: 12px;
      margin-top: 16px;
    }

    /* --- Carousel Styles (final replacement) --- */
    .carousel {
      width: 100%;
      overflow: hidden;          /* only show a few cards at a time */
      position: relative;
      margin-bottom: 0.5rem;
    }

    .carousel-track {
      display: flex;
      transition: transform 0.5s ease;
      gap: 1rem;
    }

    .carousel-card {
      flex: 0 0 300px;           /* fixed width */
      height: 300px;             /* fixed height for true square */
      border: 1px solid #333;
      border-radius: 8px;
      background: #222;          /* dark gray base */
      color: #fff;               /* white text */
      text-decoration: none;
      box-shadow: 0 2px 8px rgba(0,0,0,0.4);
      overflow: hidden;
    }

    .carousel-card:hover {
      background-color: #1a3d66; /* deep blue hover */
      border-color: #0066cc;     /* bright blue border */
      transform: translateY(-4px);
    }

    .carousel-img {
      width: 100%;
      height: 180px;             /* roomy image area */
      object-fit: cover;
      border-bottom: 1px solid #444;
    }

    .carousel-card h3 {
      font-size: 1.1rem;
      margin: 0.5rem;
      line-height: 1.3;
    }

    .carousel-card p {
      font-size: 0.85rem;
      color: #ccc;
      margin: 0 0.5rem 0.5rem;
    }

    /* --- Arrow Controls --- */
    .carousel-controls {
      display: flex;
      justify-content: center;
      gap: 1rem;
      margin-bottom: 2rem;
    }

    .carousel-btn {
      background: #222;
      color: #fff;
      border: 1px solid #444;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      font-size: 1.2rem;
      cursor: pointer;
      transition: background-color 0.2s ease, transform 0.2s ease;
    }

    .carousel-btn:hover {
      background-color: #0066cc; /* blue hover */
      transform: scale(1.1);
    }
  </style>
</head>
<body>
  <header>
    <div class="header-left">
      <img src="assets/electorate-logo.png" alt="Logo" class="logo" />
    </div>
    <div class="header-right">
      <input type="text" id="search-bar" placeholder="Search officials..." />
      <label for="state-dropdown">State:</label>
      <select id="state-dropdown">
        <option value="Alabama">Alabama</option>
        <option value="Alaska">Alaska</option>
        <option value="American Samoa">American Samoa</option>
        <option value="Arizona">Arizona</option>
        <option value="Arkansas">Arkansas</option>
        <option value="California">California</option>
        <option value="Colorado">Colorado</option>
        <option value="Connecticut">Connecticut</option>
        <option value="Delaware">Delaware</option>
        <option value="District of Columbia">District of Columbia</option>
        <option value="Florida">Florida</option>
        <option value="Georgia">Georgia</option>
        <option value="Guam">Guam</option>
        <option value="Hawaii">Hawaii</option>
        <option value="Idaho">Idaho</option>
        <option value="Illinois">Illinois</option>
        <option value="Indiana">Indiana</option>
        <option value="Iowa">Iowa</option>
        <option value="Kansas">Kansas</option>
        <option value="Kentucky">Kentucky</option>
        <option value="Louisiana">Louisiana</option>
        <option value="Maine">Maine</option>
        <option value="Maryland">Maryland</option>
        <option value="Massachusetts">Massachusetts</option>
        <option value="Michigan">Michigan</option>
        <option value="Minnesota">Minnesota</option>
        <option value="Mississippi">Mississippi</option>
        <option value="Missouri">Missouri</option>
        <option value="Montana">Montana</option>
        <option value="Nebraska">Nebraska</option>
        <option value="Nevada">Nevada</option>
        <option value="New Hampshire">New Hampshire</option>
        <option value="New Jersey">New Jersey</option>
        <option value="New Mexico">New Mexico</option>
        <option value="New York">New York</option>
        <option value="North Carolina">North Carolina</option>
        <option value="North Dakota">North Dakota</option>
        <option value="Northern Mariana Islands">Northern Mariana Islands</option>
        <option value="Ohio">Ohio</option>
        <option value="Oklahoma">Oklahoma</option>
        <option value="Oregon">Oregon</option>
        <option value="Pennsylvania">Pennsylvania</option>
        <option value="Puerto Rico">Puerto Rico</option>
        <option value="Rhode Island">Rhode Island</option>
        <option value="South Carolina">South Carolina</option>
        <option value="South Dakota">South Dakota</option>
        <option value="Tennessee">Tennessee</option>
        <option value="Texas">Texas</option>
        <option value="Utah">Utah</option>
        <option value="Vermont">Vermont</option>
        <option value="Virgin Islands">U.S. Virgin Islands</option>
        <option value="Virginia">Virginia</option>
        <option value="Washington">Washington</option>
        <option value="West Virginia">West Virginia</option>
        <option value="Wisconsin">Wisconsin</option>
        <option value="Wyoming">Wyoming</option>
      </select>
    </div>
  </header>

  <nav id="hub-nav">
    <button class="tab" onclick="showStartupHub()">Home Hub</button>
    <button class="tab" onclick="showPodcastsShows()">Podcasts & Shows</button>
    <button class="tab" onclick="renderOfficials(selectedState, '')">My Officials</button>
    <button class="tab" onclick="showCivic()">Civic Intelligence</button>
    <button class="tab" onclick="showPolls()">Polls</button>
    <button class="tab" onclick="showOrganizations()">Political Groups</button>
    <button class="tab" onclick="showVoting()">Voting</button>
  </nav>
  <main>
    <!-- Startup Hub Tab -->
    <section id="startup-hub" class="tab-content" style="display: none;">
      <h2>Home Hub</h2>

      <!-- National Broadcasting Networks -->
      <div id="national-networks" class="category-section">
        <h2>National Broadcasting Networks</h2>
        <div class="card-grid" id="network-cards">
          <div class="info-card" data-network="livenowfox">
            <a href="https://www.livenowfox.com/live" target="_blank" rel="noopener noreferrer">
              <img src="/assets/livenowfox.png" alt="LiveNOW FOX Logo" class="network-logo">
              <h3>LiveNOW from FOX</h3>
              <p>Raw &amp; Unfiltered News 24/7 Live News Stream.</p>
            </a>
          </div>
          <div class="info-card" data-network="msnbc">
            <img src="/assets/msnbc.png" alt="MSNBC Logo" class="network-logo">
            <h3>MSNBC</h3>
            <p>A counter to FOX News coverage.</p>
          </div>
          <div class="info-card" data-network="abc">
            <img src="/assets/abc.png" alt="ABC News Logo" class="network-logo">
            <h3>ABC News</h3>
            <p>National news coverage from ABC.</p>
          </div>
          <div class="info-card" data-network="cbs">
            <img src="/assets/cbs.png" alt="CBS News Logo" class="network-logo">
            <h3>CBS News</h3>
            <p>CBS News broadcasts and updates.</p>
          </div>
          <div class="info-card" data-network="fox">
            <img src="/assets/fox.png" alt="FOX News Logo" class="network-logo">
            <h3>FOX News</h3>
            <p>Latest stories from FOX News.</p>
          </div>
          <div class="info-card" data-network="cnn">
            <img src="/assets/cnn.png" alt="CNN Logo" class="network-logo">
            <h3>CNN</h3>
            <p>Breaking news and political analysis from CNN.</p>
          </div>
        </div>
      </div>

      <!-- Single feed viewer -->
      <div id="feed-viewer" class="feed-viewer">
        <h3 id="feed-title">Select a network to view stories</h3>
        <div class="story-grid" id="feed-stories">
          <!-- RSS feed stories will populate here -->
        </div>
      </div>

      <!-- Global Politics & World News -->
      <div id="world-news" class="hub-section">
        <h2>Global Politics &amp; World News</h2>
        <div id="world-news-carousel" class="carousel"></div>
        <div class="carousel-controls">
          <button class="carousel-btn prev" data-target="world-news-carousel">&#9664;</button>
          <button class="carousel-btn next" data-target="world-news-carousel">&#9654;</button>
        </div>
      </div>

      <!-- Finance & Markets -->
      <div id="finance-markets" class="hub-section">
        <h2>Finance &amp; Markets</h2>
        <div id="finance-carousel" class="carousel"></div>
        <div class="carousel-controls">
          <button class="carousel-btn prev" data-target="finance-carousel">&#9664;</button>
          <button class="carousel-btn next" data-target="finance-carousel">&#9654;</button>
        </div>
      </div>

      <!-- Economy -->
      <div id="economy" class="hub-section">
        <h2>Economy</h2>
        <div id="economy-carousel" class="carousel"></div>
        <div class="carousel-controls">
          <button class="carousel-btn prev" data-target="economy-carousel">&#9664;</button>
          <button class="carousel-btn next" data-target="economy-carousel">&#9654;</button>
        </div>
      </div>

      <!-- Popular Podcasts -->
      <div id="popular-podcasts" class="category-section">
        <h2>Popular Podcasts</h2>
        <div class="card-grid">
          <div class="info-card"><h3>Pod Save America</h3><p>Political commentary from Pod Save America.</p></div>
          <div class="info-card"><h3>The Daily (NYT)</h3><p>News analysis and storytelling from The Daily.</p></div>
          <div class="info-card"><h3>NPR Politics</h3><p>Political coverage and analysis from NPR.</p></div>
        </div>
      </div>

      <!-- Social Trends Section -->
      <div id="social-trends" class="hub-section">
        <h2>Trending Now</h2>
        <div id="social-feed" class="grid"></div>
      </div>
    </section>
    <section id="podcasts-shows" class="tab-content" style="display: none;">
      <h2>Podcasts & Shows</h2>
      <input 
        type="text" 
        id="podcasts-search-bar" 
        class="search-bar" 
        placeholder="Search podcasts or shows..."
        style="
          width: 100%;
          max-width: 400px;
          padding: 10px 15px;
          margin: 10px 0 20px 0;
          border-radius: 8px;
          border: 1px solid #ccc;
          background-color: #2b2b2b;
          color: #fff;
          font-size: 1rem;
          transition: border-color 0.2s, box-shadow 0.2s;
        "
        onfocus="this.style.borderColor='#1e90ff'; this.style.boxShadow='0 0 5px #1e90ff';"
        onblur="this.style.borderColor='#ccc'; this.style.boxShadow='none';"
      />
      <div id="podcasts-cards" class="grid"></div>
    </section>

    <section id="my-officials" class="tab-content" style="display: none; position: relative;">
      <h2>My Officials</h2>
      <div id="loading-overlay" style="
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          display: flex;
          align-items: center;
          justify-content: center;
          background: rgba(255,255,255,0.8);
          font-size: 1.5rem;
          font-weight: bold;
          z-index: 1000;
        ">
        Loading officials...
      </div>
      <div id="officials-container" class="grid"></div>
    </section>

<section id="civic" class="tab-content" style="display: none;">
  <h2>Civic Intelligence Dashboard</h2>
  <div id="calendar"></div>

  <!-- Place the launcher here so it only shows in this tab -->
  <div id="daily-civics-test-launcher">
    <h3>Daily Civics Test</h3>
    <p>Test your United States government, economics, and history knowledge.</p>
    <button onclick="openCivicsQuizModal()">Start todayâ€™s test</button>
  </div>
</section>

    <section id="polls" class="tab-content" style="display: none;">
      <h2>Polling Dashboard</h2>
      <div id="polls-cards" class="grid"></div>
    </section>

    <section id="organizations" class="tab-content" style="display: none;">
      <h2>Political Organizations</h2>
      <div class="organization-grid"></div>
    </section>

    <section id="voting" class="tab-content" style="display: none;">
      <h2>Voting & Registration</h2>
      <div id="voting-cards">
        <section id="voting-cards"></section>
      </div>
    </section>
  </main>

  <!-- Officials Modal -->
  <div id="officials-modal" class="modal">
    <div class="modal-content" id="officials-content"></div>
    <button id="close-modal" class="close-button">&times;</button>
  </div>

  <!-- Poll Modal -->
  <div id="pollModal" class="modal">
    <div class="modal-content" id="pollModalContent"></div>
  </div>

  <!-- Modal for Polls -->
  <div id="polls-modal" class="modal">
    <div id="polls-content" class="modal-content"></div>
  </div>

  <!-- === Civics Quiz Modal === -->
<div id="civicsQuizModal" class="modal" style="display:none;">
  <div class="modal-content">
    <span class="close" onclick="closeModalWindow('civicsQuizModal')">&times;</span>
    <div id="civics-quiz">
      <h2>Daily Civics Test</h2>
      <p>Test your United States government, economics, and history knowledge.</p>

      <!-- Progress bar -->
      <div id="quiz-progress-bar">
        <div id="quiz-progress-fill"></div>
      </div>

      <!-- Progress text -->
      <div id="quiz-progress"></div>

      <!-- Question -->
      <div id="quiz-question"></div>

      <!-- Options -->
      <div id="quiz-options"></div>

      <!-- Controls -->
      <div id="quiz-controls">
        <button id="quiz-submit">Submit</button>
        <button id="quiz-next" style="display:none;">Next</button>
      </div>

      <!-- Feedback + Score -->
      <div id="quiz-feedback"></div>
      <div id="quiz-score"></div>
    </div>
  </div>
</div>

  <!-- Cabinet Modal -->
  <div id="cabinetModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeModalWindow('cabinetModal')">&times;</span>
      <div id="cabinetGridView">
        <div id="cabinetList" class="officials-grid"></div>
      </div>
      <div id="cabinetDetailView" style="display:none;">
        <button onclick="backToCabinetGrid()">Back</button>
        <div id="cabinetMemberDetail"></div>
      </div>
    </div>
  </div>
  <script>
    // Show Home Hub tab
    function showStartupHub() {
      showTab('startup-hub');
    }

    // Other tab helpers (placeholders to match your button handlers)
    function showPodcastsShows() { showTab('podcasts-shows'); }
    function showCivic() { showTab('civic'); }
    function showPolls() { showTab('polls'); }
    function showOrganizations() { showTab('organizations'); }
    function showVoting() { showTab('voting'); }

    // Generic tab switcher
    function showTab(tabId) {
      document.querySelectorAll('.tab-content').forEach(tab => {
        tab.style.display = 'none';
      });
      const tab = document.getElementById(tabId);
      if (tab) tab.style.display = 'block';
    }

    // Sticky nav buttons scroll to sections
    document.addEventListener('DOMContentLoaded', () => {
      const navButtons = document.querySelectorAll('#hub-nav button');
      navButtons.forEach(btn => {
        btn.addEventListener('click', () => {
          const section = document.getElementById(btn.dataset?.target);
          if (section) section.scrollIntoView({ behavior: 'smooth', block: 'start' });
        });
      });

      // Force Home Hub tab to show on page load (prevents any flash)
      showStartupHub();
    });

    // --- Carousel Feed Logic (image-enforced, 25 items, rotating track + arrows) ---
  const feeds = {
  world: [
    "https://feeds.bbci.co.uk/news/world/rss.xml",
    "https://rss.nytimes.com/services/xml/rss/nyt/World.xml",
    "https://www.aljazeera.com/xml/rss/all.xml"
  ],
  finance: [
    "https://www.investing.com/rss/news.rss",
    "https://www.investing.com/rss/news_25.rss",
    "https://www.investing.com/rss/news_301.rss"
  ],
  economy: [
    "https://www.investing.com/rss/news_25.rss",
    "https://www.investing.com/rss/news_301.rss",
    "https://www.investing.com/rss/news_274.rss"
  ]
};

    async function loadFeed(url) {
      try {
        const response = await fetch(
          `https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(url)}`
        );
        const data = await response.json();
        return data.items || [];
      } catch {
        return [];
      }
    }

    function extractImage(item) {
      if (item.thumbnail) return item.thumbnail;
      if (item.enclosure && item.enclosure.link) return item.enclosure.link;
      const match = item.content?.match(/<img[^>]+src="([^">]+)"/i);
      if (match && match[1]) return match[1];
      return "";
    }

    async function loadSection(section, containerId) {
      const container = document.getElementById(containerId);
      const track = document.createElement("div");
      track.className = "carousel-track";
      container.appendChild(track);

      let allItems = [];
      for (const url of feeds[section]) {
        const items = await loadFeed(url);
        allItems = allItems.concat(items);
      }

      const withImages = allItems
        .map(item => ({ item, img: extractImage(item) }))
        .filter(({ img }) => !!img)
        .slice(0, 25); // enforce cap of 25 with images

      withImages.forEach(({ item, img }) => {
        const card = document.createElement("a");
        card.className = "hub-card carousel-card";
        card.href = item.link;
        card.target = "_blank";
        card.rel = "noopener noreferrer";
        card.innerHTML = `
          <img src="${img}" alt="" class="carousel-img">
          <h3>${item.title}</h3>
          <p>${new Date(item.pubDate).toLocaleDateString()}</p>
        `;
        track.appendChild(card);
      });
    }

    function setupControls(containerId) {
      const track = document.querySelector(`#${containerId} .carousel-track`);
      const prevBtn = document.querySelector(`.carousel-controls .prev[data-target="${containerId}"]`);
      const nextBtn = document.querySelector(`.carousel-controls .next[data-target="${containerId}"]`);

      let position = 0;
      const step = 310; // card width + ~gap

      // Auto-scroll (5 seconds)
      setInterval(() => {
        position++;
        if (position >= track.children.length) position = 0;
        track.style.transform = `translateX(-${position * step}px)`;
      }, 5000);

      // Manual controls
      prevBtn.addEventListener("click", () => {
        position = Math.max(0, position - 1);
        track.style.transform = `translateX(-${position * step}px)`;
      });

      nextBtn.addEventListener("click", () => {
        position = Math.min(track.children.length - 1, position + 1);
        track.style.transform = `translateX(-${position * step}px)`;
      });
    }
  </script>
  <script src="script.js"></script>

<script>
  // Initialize carousels: load feeds then wire controls
  (async () => {
    await loadSection("world", "world-news-carousel");
    await loadSection("finance", "finance-carousel");
    await loadSection("economy", "economy-carousel");

    setupControls("world-news-carousel");
    setupControls("finance-carousel");
    setupControls("economy-carousel");
  })();
</script>

<script>
  // Force Home Hub tab to show on page load and highlight its button
  document.addEventListener("DOMContentLoaded", () => {
    showStartupHub(); // Home Hub loads first and button is highlighted
  });
</script>

</body>
</html>
