      - name: Generate senators-rankings.json
        env:
          CONGRESS_API_KEY: ${{ secrets.CONGRESS_API_KEY }}
          PROPUBLICA_API_KEY: ${{ secrets.PROPUBLICA_API_KEY }}
        run: |
          node - <<'NODE'
const fs = require('fs');
const path = require('path');

// … all your helper functions and buildRecord go here …

(async () => {
  const records = await Promise.all(senators.map(buildRecord));
  fs.mkdirSync(path.dirname(outFile), { recursive: true });
  fs.writeFileSync(outFile, JSON.stringify(records, null, 2), 'utf-8');
  console.log('Wrote', records.length, 'senators to', outFile);
})();
NODE
